<%- include('../includes/head.ejs') %>
<%- include('../includes/variant-scripts.ejs') %>

</head>
<body class="ms-body ms-aside-left-open ms-primary-theme ms-has-quickbar">
   <%- include('../includes/navigation.ejs') %>
   <main class="body-content">
      <%- include('../includes/navigation-bar.ejs') %>
      <form
         class="ms-content-wrapper" name="myForm"
         action="/admin/<% if (editing) { %>edit-variant<% } else { %>add-variant<% } %>"
         method="POST"
         enctype="multipart/form-data"
         id="variant_form">
         <% if (editing) { %>
         <% for (let i = 0; i < variant.length; i++) { %>
         <% if (variant[i].productVariantsExtras[0].active ==1) { %>
         <script>
            $(document).ready(function() {
            var activeCheckbox ="<%= variant[i].productVariantsExtras[0].extraId %>";
            $('.status-checkbox-'+activeCheckbox).prop('checked', true);
            $('.status-'+activeCheckbox).val('on');
            });
         </script>
         <% } 
            %>
         <% } %>
         <% } %>
         <% if (editing) { %>
         <% for (let i = 0; i < variant.length; i++) { %>
         <% if (  variant[i].productVariantsExtras[0].requiredExtra == 1) { %>
         <script>
            $(document).ready(function() {
            var activeCheckbox ="<%= variant[i].productVariantsExtras[0].extraId %>";
            $('.status-checkbox-option-'+activeCheckbox).prop('checked', true);
            $('.statusOption'+activeCheckbox).val('on');
            });
         </script>
         <% } 
            %>
         <% } %>
         <% } %>
         <div class="row">
            <div class="col-xl-6 col-md-12">
               <div class="ms-panel ms-panel-fh">
                  <div class="ms-panel-header">
                     <h6>Add Product Form</h6>
                  </div>
                  <div class="ms-panel-body">
                     <div class="form-row">
                        <div class="col-md-12 mb-3">
                           <label for="sku">Sku</label>
                           <div class="input-group">
                              <input
                                 class="form-control"
                                 type="text"
                                 name="sku"
                                 id="sku"
                                 value="<% if (editing) { %><%= variant[0].productVariantsExtras[0].productVariant.sku %><% } %>">
                           </div>
                           <span class="error_form" id="sku_error_message"></span>
                        </div>
                        <% if (editing) { %>
                        <div class="col-md-6 mb-3">
                           <label for="validationCustom22">RO</label>
                           <div class="input-group">
                              <select class="form-control" for="categoryRo" id="categoryRo" name="categoryRo">
                                 <option disabled="true" value="list">Variáns kategótia</option>
                                 <% for(let i = 0; i < cat.length; i++) { %>
                                 <option id="categoryRo" name="categoryRo" value='<%= cat[i].id %>'><%= cat[i].productCategoryTranslations[`${currentLanguage}`].name %></option>
                                 <% } %>
                              </select>
                           </div>
                           <span class="error_form" id="category_error_message"></span>
                        </div>
                        <% } else { %>
                        <div class="col-md-6 mb-3">
                           <label for="validationCustom22">RO</label>
                           <div class="input-group">
                              <select class="form-control" for="categoryRo" id="categoryRo" name="categoryRo">
                                 <option disabled="true" value="list">Variáns kategótia</option>
                                 <% for(let i = 0; i < cat.length; i++) { %>
                                 <option id="categoryRo" name="categoryRo" value='<%= cat[i].id %>'><%= cat[i].productCategoryTranslations[`${currentLanguage}`].name %></option>
                                 <% } %>
                              </select>
                           </div>
                           <span class="error_form" id="category_error_message"></span>
                        </div>
                        <% } %>
                      
                         
                        <div>
                           <div>
                              <div class="form-group">
                                 <label for="maxOption">Example select</label>
                                 <select class="form-control" name="maxOption" id="maxOption">
                                    <option value="0" selected="selected">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                  </select>
                              </div>
                           </div>
                           <% if (editing) { %>
                           <input type="hidden" value="<%= variantIdByParams %>" name="variantId">
                           <% } %>
                           <button class="btn btn-success has-icon" id="votebutton" type="submit">
                           <% if (editing) { %>Update Product<% } else { %>Add
                           Product<% } %>
                           </button>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         </div>
         </div>
         <input type="text" name="search" id="search" placeholder="Search extra" class="form-control"
            />
         <div class="ms-panel ms-btn-display">
            <div class="ms-panel-header">
               <h6>A  hozzárendelhető extrái:</h6>
            </div>
         </div>
         <% if (editing) { %>  <% if (productVarToExt.length > 0) { %>
         <div class="ms-content-wrapper">
            <div class="row">
               <div class="col-md-12">
                  <div id="searchedExtra" class="row">
                     <input
                        type="hidden"
                        value="<%= varId %>"
                        name="varId"
                        />  
                     <% for (let i = 0; i < variant.length; i++) { %>
                     <input
                        type="hidden"
                        value="<%= variant[i].productVariantsExtras[0].extraId %>"
                        name="extraId"
                        />          
                     <div class="col-xl-3 cfol-lg-4 col-md-6 col-sm-6 extra_box" data-extra="<%= variant[i].productVariantsExtras[0].extraId %>">
                        <div class="ms-card">
                           <div class="d-flex justify-content-center extra-margin-top">
                              <div class="row"> 
                                 <label class="ms-switch" >                 
                                 <input type="hidden" value="off" class="status-<%= variant[i].productVariantsExtras[0].extraId %>" name="status[<%= variant[i].productVariantsExtras[0].extraId %>]" >          
                                 <input    data-extraId="<%= variant[i].productVariantsExtras[0].extraId %>"  class="status-checkbox status-checkbox-<%= variant[i].productVariantsExtras[0].extraId %>" type="checkbox">
                                 <span class="ms-switch-slider ms-switch-success round"></span>
                                 </label> 
                              </div>
                           </div>
                           <hr>
                           <div class="d-flex justify-content-center extra-margin-top">
                              <label class="ms-checkbox-wrap ms-checkbox-success">
                              <input type="hidden" value="off" class="statusOption<%= variant[i].id %>" name="statusOption[<%= variant[i].id %>]" >    
                              <input data-optionId="<%= variant[i].id %>" class="status-checkbox-option status-checkbox-option-<%= variant[i].id %>" type="checkbox"  > <i class="ms-checkbox-check"></i>
                              </label> <span> Opció lehetőség </span>
                           </div>
                           <div class="ms-card-body">
                              <div class="new d-flex justify-content-center extra-name">
                                 <h6 class="mb-0"><b><%=  variant[i].extraTranslations[`${currentLanguage}`].name %></b> </h6>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="price">Price</label>
                                 <div class="input-group">
                                    <input
                                       class="price_<%= variant[i].productVariantsExtras[0].extraId %> extra_price_input"
                                       type="text"
                                       name="price"
                                       id="price"
                                       value="<% if (editing) { %><%= variant[i].productVariantsExtras[0].price %><% } %>"
                                       />
                                 </div>
                                 <span class="extra_error_message error_form" id="price_error_message_<%= variant[i].productVariantsExtras[0].extraId %>"></span>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="discountedPrice"
                                    >Discounted Price</label
                                    >
                                 <div class="input-group">
                                    <input disabled
                                       class="form-control"
                                       type="text"
                                       name="discountedPrice"
                                       id="discountedPrice"
                                       value="<% if (editing) { %><%= variant[i].productVariantsExtras[0].discountedPrice %><% } %>"
                                       />
                                 </div>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="quantityMin"
                                    >Quantity Minimum</label
                                    >
                                 <div class="input-group">
                                    <input
                                       class="qtMin_<%= variant[i].productVariantsExtras[0].extraId %> extra_qtMin_input"
                                       type="number" 
                                       name="quantityMin"
                                       id="quantityMin"
                                       onKeyDown="if(this.value.length==18) return false;"
                                       value="<% if (editing) { %><%= variant[i].productVariantsExtras[0].quantityMin %><% } %>"
                                       />
                                 </div>
                                 <span class="extra_error_message error_form" id="qtMin_error_message_<%= variant[i].productVariantsExtras[0].extraId %>"></span>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="quantityMax"
                                    >Quantity Maximum</label
                                    >
                                 <div class="input-group">
                                    <input
                                       class="qtMax_<%= variant[i].productVariantsExtras[0].extraId %> extra_qtMax_input"
                                       type="text"
                                       name="quantityMax"
                                       id="quantityMax"
                                       value="<% if (editing) { %><%= variant[i].productVariantsExtras[0].quantityMax %><% } %>"
                                       />
                                 </div>
                                 <span class="extra_error_message error_form" id="qtMax_error_message_<%= variant[i].productVariantsExtras[0].extraId %>"></span>
                              </div>
                           </div>
                        </div>
                     </div>
                     <% } %>
                  </div>
               </div>
            </div>
         </div>
         <% } else { %>
         <% } %><% } else { %>
         <% if (ext.length > 0) { %>
         <div class="ms-content-wrapper">
            <div class="row">
               <div class="col-md-12">
                  <div  id="searchedExtra" class="row">
                     <% for (let i=0; i < ext.length; i++ ) { %>
                     <input
                        type="hidden"
                        value="<%= ext[i].id %>"
                        name="extraId"
                        />          
                     <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 extra_box" data-extra="<%= ext[i].id %>">
                        <div class="ms-card">
                           <div class="d-flex justify-content-center extra-margin-top">
                              <div class="row">
                                 <label class="ms-switch" >                 
                                 <input type="hidden" value="off" class="status-<%= ext[i].id %>" name="status[<%= ext[i].id %>]" >          
                                 <input data-extraId="<%= ext[i].id %>" class="status-checkbox status-checkbox-<%= ext[i].id %>" type="checkbox"> <span class="ms-switch-slider ms-switch-success round"></span>
                                 </label> 
                                 <div>Extra feltétel lehetőség</div>
                              </div>
                           </div>
                           <hr>
                           <div class="d-flex justify-content-center extra-margin-top">
                              <label class="ms-checkbox-wrap ms-checkbox-success">
                              <input type="hidden" value="off" class="statusOption<%= ext[i].id %>" name="statusOption[<%= ext[i].id %>]" >    
                              <input data-optionId="<%= ext[i].id %>"  class="status-checkbox-option status-checkbox-option-<%= ext[i].id %>" type="checkbox"  > <i class="ms-checkbox-check"></i>
                              </label> <span> Opció lehetőség </span>
                           </div>
                           <div class="ms-card-body">
                              <div class="new d-flex justify-content-center extra-name">
                                 <h6 class="mb-0"><b><%= currentExtraName[i] %></b> </h6>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="price">Price</label>
                                 <div class="input-group">
                                    <input
                                       class="price_<%= ext[i].id %> extra_price_input"
                                       type="text"
                                       name="price"
                                       id="price"
                                       value="<% if (editing) { %><%= ext[i].price %><% } %>"
                                       />
                                 </div>
                                 <span class="extra_error_message error_form" id="price_error_message_<%= ext[i].id %>"></span>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="discountedPrice"
                                    >Discounted Price</label
                                    >
                                 <div class="input-group">
                                    <input disabled
                                       class="form-control"
                                       type="text"
                                       name="discountedPrice"
                                       id="discountedPrice"
                                       value="<% if (editing) { %><%= ext[i].discountedPrice %><% } %>"
                                       />
                                 </div>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="quantityMin"
                                    >Quantity Minimum</label
                                    >
                                 <div class="input-group">
                                    <input
                                       class="qtMin_<%= ext[i].id %> extra_qtMin_input"
                                       type="number"
                                       name="quantityMin"
                                       id="quantityMin"
                                       onKeyDown="if(this.value.length==18) return false;"
                                       value="<% if (editing) { %><%= ext[i].quantityMin %><% } %>"
                                       />
                                 </div>
                                 <span class="extra_error_message error_form" id="qtMin_error_message_<%= ext[i].id %>"></span>
                              </div>
                              <div class="col-md-12 mb-3">
                                 <label for="quantityMax"
                                    >Quantity Maximum</label
                                    >
                                 <div class="input-group">
                                    <input
                                       class="qtMax_<%= ext[i].id %> extra_qtMax_input"
                                       type="text"
                                       name="quantityMax"
                                       id="quantityMax"
                                       value="<% if (editing) { %><%= ext[i].quantityMax %><% } %>"
                                       />
                                 </div>
                                 <span class="extra_error_message error_form" id="qtMax_error_message_<%= ext[i].id %>"></span>
                              </div>
                           </div>
                        </div>
                     </div>
                     <% } %>
                  </div>
               </div>
            </div>
         </div>
         <% } else { %>
         <% } %>
         <% } %> 
      </form>
   </main>
   <%- include('../includes/end.ejs') %>
</body>