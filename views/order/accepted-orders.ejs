<%- include('../includes/head.ejs') %>
</head>
<body class="ms-body ms-aside-left-open ms-primary-theme ms-has-quickbar">
<%- include('../includes/navigation.ejs') %>

  <main class="body-content">
    <%- include('../includes/navigation-bar.ejs') %>
    <div class="ms-content-wrapper">
      <div class="ms-profile-overview no-img-var">
         <ul class="ms-profile-navigation nav nav-tabs tabs-bordered" role="tablist">
            <li role="presentation"><a class="add-variant" href="/admin/orders">Új rendelések</a></li>
            <li role="presentation"><a href="#" aria-controls="tab1" class="active show" role="tab" data-toggle="tab">Elfogadott rendelések </a></li>
            <li role="presentation"><a class="add-extra" href="/admin/deleted-orders">Törölt rendelések </a></li>
         </ul>
        
      </div>
   </div>
   <% if (orders.length ==0) { %>
      <h2>Order not found</h2>
    <% } %>
    <% for (let i =0; i < orders.length; i++) { %>
      <p>
      <div class="ms-content-wrapper" data-toggle="collapse" name="orders" value="#orders<%= orders[i].id %>" href="#orders<%= orders[i].id %>" aria-expanded="false" aria-controls="orders<%= orders[i].id %>">
        <div class="table-responsive ">
          <table class="table table-hover thead-primary ">
            <thead class="accepted-order-list">
              <tr>
                <th scope="col">Rendelési szám</th>
                <th scope="col">Név</th>
                <th scope="col">Hova</th>
                <th scope="col">Végösszeg</th>
                <th scope="col">Statusz</th>
                <th scope="col">Megtekintés</th>
              
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">#<%= orders[i].id %></th>
                <td><%= orders[i].OrderDeliveryAddress.userName %></td>
                <td>Székelyudvarhely</td>
                <td>145,66</td>
                <td>Elfogadott</td>
                <td>
                  <div>
                  <a href="/admin/edit-order/<%= orders[i].id %>?edit=true"class="btn grid-btn mt-0 btn-sm btn-secondary" >Megtekintés</a>
                  </div>
                </td>
             
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </p>
    <div class="collapse" name="orders"  value="#orders<%= orders[i].id %>" id="orders<%= orders[i].id %>">
    <form
    id="createBox_form"
    class="ms-content-wrapper"
    action="/admin/<% if (editing) { %>edit-order<% } else { %>edit-order<% } %>"
    method="POST">
    <div class="ms-content-wrapper">
      <div class="row">
         <div class="col-md-12">
            <div class="ms-panel">
               <div class="ms-panel-header header-mini">
                  <div class="d-flex justify-content-between">
                     <h6>Szamla</h6>
                     <h6>#<%= orders[i].id %></h6>
                  </div>
               </div>
               <div class="ms-panel-body">
                  <!-- Invoice To -->
                  <h4>Kliens adatai: </h4>
                  <div class="row align-items-center border-orders-userinf">
                     <div class="col-md-6 info-orders-top">
                        <div class="invoice-address">
                           <h5>Név: <%= orders[i].OrderDeliveryAddress.userName %></h5>
                           <h5>
                           Telefonszám: <%= orderPhoneNumber %> 
                           <h5>
                           <h5>
                           Utca: <%= orders[i].OrderDeliveryAddress.street %> 
                           <h5>
                           <h5>
                           Házszám: <%= orderHouseNumber %> 
                           <h5>
                           <h5>
                           Emelet: <%= orderFloor %> 
                           <h5>
                           <h5>
                           Ajtó: <%= orderDoorNumber %> 
                           <h5>
                            
                        </div>
                     </div>
                     <div class="col-md-6 text-md-right">
                        <ul class="invoice-date">
                           <li>Invoice Date : <%= orderCreated %></li>
                        </ul>
                     </div>
                
                    
                   
                  </div>
                  <!-- Invoice Table -->
                  <% for (let j =0; j < orders[i].products.length; j++) { %>
                  <div class="ms-invoice-table table-responsive mt-5">
                     <table class="table table-hover text-right thead-light">
                        <thead>
                           <tr class="text-capitalize">
                              <th class="text-center w-5">id</th>
                              <th class="text-left">Product Name</th>
                              <th>qty</th>
                              <th>Termek ar</th>
                              <th>total</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td class="text-center"><%= orders[i].products[j].product_id %></td>
                              <td class="text-left"><%= orders[i].products[j].product_name %></td>
                              <td><%= orders[i].products[j].product_quantity %></td>
                              <td><%= orders[i].products[j].product_price %></td>
                              <td><%= orders[i].products[j].total_product_price %></td>
                           </tr>
                           <% for (let k = 0; k < orders[i].products[j].extras.length; ++k) { %>
                           <tr>
                              <td class="text-center"><%=  orders[i].products[j].extras[k].extra_id%></td>
                              <td class="text-left"><%=  orders[i].products[j].extras[k].extra_name%></td>
                              <td><%=  orders[i].products[j].extras[k].extra_quantity%></td>
                              <td>$<%=  orders[i].products[j].extras[k].extra_price%></td>
                              <td><%=  orders[i].products[j].extras[k].total_extra_price%></td>
                           </tr>
                           <% } %>        
                        </tbody>
                        <tfoot>
                           <tr>
                              <td colspan="4">Total Cost:</td>
                              <td>$<%= orders[i].products[j].total_cost_produce_extra %></td>
                           </tr>
                        </tfoot>
                     </table>
                  </div>
                 
                  <% } %>
                  <input
                  type="hidden"
                  value="<%= orders[i].encodedKey %>"
                  name="orderId"
                  />
               
               
               </div>
            </div>
         </div>
      </div>
      </div>
     </form>
     <!-- End -->
     </div>
    
    <% } %>

  </main>
 
<%- include('../includes/end.ejs')
  %>
</body>